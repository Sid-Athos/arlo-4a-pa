version: "3"
services:
  api:
    container_name: "api"
    image: dixennaxos/pa-4al2-gr5:api-${ENV}-latest
    ports:
      - '7590:7590'
    restart: "always"
    tty: true
    volumes:
      - "./api/.env:/.env"
      - "./api/logs:/logs"
  gamemanager:
    container_name: "gamemanager"
    image: dixennaxos/pa-4al2-gr5:game-manager-${ENV}-latest
    ports:
      - '7589:7589'
    restart: "always"
    tty: true
    volumes:
      - "./game-manager/.env:/.env"
      - "./game-manager/logs:/logs"
  front:
    container_name: "front"
    image: dixennaxos/pa-4al2-gr5:front-${ENV}-latest
    ports:
      - '3000:3000'
    restart: "always"
    tty: true
    volumes:
      - "./web/coding-games/.env:/.env"
  nginx:
    container_name: "nginx"
    image: nginx:latest
    ports:
      - '80:80'
      - "443:433"
    restart: always
    volumes:
      - ../arlo-4a-pa-conf/nginx/conf/:/etc/nginx/conf.d/:ro
      - ../certbot/www:/var/www/certbot/:ro
      - ../certbot/conf/:/etc/nginx/ssl/:ro
  certbot:
    container_name: "certbot"
    image: certbot/certbot:latest
    volumes:
      - ../certbot/www/:/var/www/certbot/:rw
      - ../certbot/conf/:/etc/letsencrypt/:rw
